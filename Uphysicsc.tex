\documentclass[twocolumn,12pt,a4paper]{article}

\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{multicol}
\usepackage[top=3cm, bottom=3cm, left=2.5cm, right=2.5cm]{geometry}
\usepackage[bookmarks=true,bookmarksnumbered=true,hidelinks]{hyperref}
\usepackage{fancyhdr,lastpage}
\renewcommand{\footrulewidth}{0.4pt}
\usepackage[bf,sf]{titlesec}
\usepackage[font={footnotesize,sf}]{caption}
\usepackage{siunitx}
\usepackage{titling,graphicx}
\usepackage{abstract}
\usepackage{amsmath}
\usepackage{siunitx, minted}
\usepackage{bibtopic}

\pagestyle{fancy}
\lhead{\textsf{Solar Sailing from Earth to Mars}}
\rhead{\textsf{Team 891}}
\cfoot{\thepage{} of \pageref*{LastPage}}

\setlength{\columnsep}{1.5cm}

% Numerar equacions amb la secci√≥
\numberwithin{equation}{section}

\author{\textsf{Team 891}}
\title{\textsf{\textbf{Problem A: Solar Sailing from Earth to Mars}}}
\date{\textsf{November 12, 2017}}
\makeindex

\begin{document}
\renewcommand{\abstractname}{}
\renewcommand{\absnamepos}{empty}
\begin{titlingpage}
 \maketitle

\noindent \hrulefill \\
\begin{abstract}
The aim of this report is to discuss the viability of a solar sail mission to Mars, in terms of payload and flight time. Results have been mainly obtain by building a model of the problem, ruled by the initial conditions and the forces acting on the spacecraft. Under some approximations, the model can be anallytically solved, but the complete set of differential equations had to be numerically solved and simulated. 

Results show such a mission would be indeed feasible, and a distrubution of weight involving a payload of \SI{1000}{kg} is suggested, giving a reasonable flight time of between 290 and 460 days, depending on trajectory. Actual arrival to Mars has been found to be uncomputable given the initial conditions, but different trajectories have been proposed to reach its orbit, or even passing close to it, as well as one accopling to it. A flight plan has been concluded for the latter, including necessary manoeuvers along the voyage. Relative velocities between the spacecraft and Mars have been computed, finding values among the interval needed for a safe landing.

\end{abstract}
\hrulefill \\

\end{titlingpage}

\begin{titlingpage}
\tableofcontents
\end{titlingpage}

\section{Introduction}

\subsection{Approach}
The motion of a solar sail within the Solar System, after a number of assumptions have been made, can be modeled by a set of relatively concise differential equations. Therefore, the problem at hand essentially becomes an initial value problem. 

As a first approximation, it can be found that a solar sail moves following as a logarithmic spiral. We used this fact to determine the feasibility of a trip from Earth to mars using solar sail propulsion, and to give a lower bound on the size of the sail for this trip to take a reasonable amount of time.

However, more complexity needed to be introduced to the model in order to understand the later stages of the trip, namely, from the point when the gravitational pull of Mars is no longer negligible. This means that the equations are no longer solvable analitically, so numerical methods must be used.

 A more detailed interpretation of the problem was needed so that a more precise model could be built. Understanding firstly the physical foundations around solar sailing was essential in order to perform an accurate analysis. Research has been done on the different forces affecting the sail for trajectories to be computed. Since some initial conditions are already given it has been necessary to verify whether these were the best options to accomplish the overall goal of the study or not.
 
  Moreover the aim of the survey is not only to calculate the path followed by the craft but also to determine its velocity so that a safe landing can be guaranteed. However, as trying to consider the attraction of Mars does not always give accurate results, this is not an easy task, though an estimate of craft arrival to Mars is presented at the end.
 
 It will be understood that the sail starts its trajectory with a radial velocity equal to the Earth's escape velocity, and with a tangential velocity equal to the Earth's linear velocity around the Sun. 
 
The release of the spacecraft will be considered at the time in which the Earth is closest to Mars, although, as it will be further discussed, results do not point in this being the best configuration. Since orbits of both planets are regarded as circular, as mentioned in the following section, this occurs when the Earth, Mars and the Sun are aligned.

The main goals of the article are to discuss a suitable distribuiton of the mass of the spacecraft, as well as to simulate possible trajectories and the arrival of the sail to Mars.

\subsection{General assumptions}
When one considers the general model of a solar sail orbiting the Sun, one finds that the acceleration of the center of mass of the sail-Sun system is non-vanishing, and therefore, taking the center of mass as the origin of the reference frame, as we do in subsequent calculations, does not yield an inertial frame. However, this acceleration is negligible and so we use the approximation that the acceleration of the center of mass of the Sun-sail system ---which can in turn be approximated by the Sun's position--- is zero.

Furthermore, the differential equations we derive assume that the sail is solely under the influence of the Sun's gravitation and radiation. The sail, however, is to be released at escape velocity from the Earth. This means that it will move in exactly the same way it would if the Earth were not there. 

Finally, for this model to be applicable, the orbits of the Earth and Mars must be assumed circular and coplanar, and the sail is assumed to remain perpendicular to the plane of the orbits.

\section{The physics of solar sailing}
We will follow \cite{tsu} and \cite[Ch. 4]{mcinnes} for most of this section.
\subsection{Radiation pressure}
It is well-known that electromagnetic wave carries an energy density. The fundamental idea behind solar sails is to use this energy as a means of propulsion in a way very much similar to how traditional sails take advantage of the kinetic energy of the wind. Given that the diameter of any reasonable solar sail will be much smaller than its distance to the Sun, one may approximate the solar radiation that arrives at the sail in the form of sinusoidal planar waves of frequency \( \omega \).

If \( E(t) \) is the amplitude of such waves, then the energy density, \( u \), they carry is given by \( u = \epsilon_0 E(t)^2 = \epsilon_0 E_0^2 \cos^2{\omega t} \). If one averages this over a period \( T \), then one obtains that the average energy density is simply \( \epsilon_0 E_0^2 /2 \), which can be rewritten as \( I/c \), where \( I \) is the intensity of the wave and \( c \) is the speed of light. Thus one finds that the pressure that incoming radiation exerts on the sail is \( I/c \). However, given that the material of the sail is not a black body, a fraction, \( R \), of the absorbed radiation will be emitted, giving rise to an additional term of pressure of the form \( RI/c \). If the sail is made out of a perfectly reflective material then it is the case that \( R = 1 \) and then the total pressure exerted on the sail is \( p = 2I/c \). This is the case for the problem at hand.

The intensity of a spherical wave is inversely proportional to the square of the distance from the source. Thus, the force exerted on the sail by the radiation from the Sun follows an inverse square law. We can make this dependence explicit by considering the equality \( Ir^2 = I_0 r^2_0 \), where \( I_0 \) is the intensity of solar radiation at a distance equal to the radius of the orbit of the Earth, \( r_0 \). And so we find that the force due to radiation pressure on a sail of surface area \( S \) is
\begin{equation}
 	\mathbf{F}_R(r) = \dfrac{2SI_0r_0^2}{c}\dfrac{1}{r^2} \mathbf{\hat{e}}_r \label{eq:radiation force}
\end{equation}

\subsection{Equations of motion for a solar sail: orthogonal case}
We have established that a solar sail that receives radiation in a direction orthogonal to itself experiences an inverse square central force. The other force acting on the sail is gravitational attraction due to the Sun ---we will consider the gravitational pull from other planets to be negligible when compared to that of the Sun---, which is also an inverse square force law. Namely:
\begin{equation}
 	\mathbf{F}_G(r) = -\dfrac{G M_S m}{r^2} \mathbf{\hat{e}}_r \label{eq:gravitational force}
\end{equation}
where \( m \) is the mass of the solar sail ---including the mass of the payload--- and \( M_S \) is the mass of the Sun.

Thus, we are now in a position to write the equations of motion for the solar sail
\begin{align}
	a_{r} &= \dot{v}_r - \dfrac{v_{\theta}^2}{r} = \dfrac{F_R - F_G}{m} \label{eq:equations of motion perpendicular} \\
	a_{\theta} &= \dot{v}_{\theta} + \dfrac{v_r v_{\theta}}{r} = 0 
\end{align}
It is common to introduce a number of parameters to better encapsulate the nature of a solar sail. The characteristic acceleration of a solar sail, \( a_R \), is defined to be the acceleration the sail experiences due to radiation pressure at a distance equal to 1 astronomical unit (AU) from the Sun. In keeping with the notation introduced in the previous section we write
\begin{equation} \label{eq:characterisit acceleration}
  a_R = \dfrac{2SI_0}{mc}
\end{equation}
It is then immediate to see that, if we denote the acceleration due to radiation pressure by \( a_R \) we have
\begin{equation}
  a(r) = a_R \dfrac{r_0^2}{r^2} 
\end{equation}
We can do the same with the acceleration due to gravity and we find
\begin{equation}
  a(r) = a_G \dfrac{r_0^2}{r^2} = \dfrac{G M_s}{r_0^2} \dfrac{r_0^2}{r^2}
\end{equation}
With this in mind we can then rewrite \autoref{eq:equations of motion perpendicular} as follows
\begin{equation} \label{eq:equations of motion characteristic accelerations}
  \dot{v}_r - \dfrac{v_{\theta}^2}{r} = (a_R - a_G) \left(\dfrac{r_0}{r}\right)^2 
\end{equation}
As we have already mentioned, this shows that the motion of a solar sail receiving radiation orthogonal to itself is governed by an inverse square law. In particular, the sail will move as if it were orbiting a star with a mass less than the Sun.

\subsection{Equations of motion for a solar sail: general case}
\begin{figure}
	\centering
	\includegraphics[scale=.4]{alpha}
	\caption{Representation of the forces acting on the sail when not in the orthogonal case. \cite{mcinnes}}
	\label{alpha}
\end{figure}

\autoref{eq:equations of motion perpendicular} only applies if the sail is orthogonal to the incoming radiation. Indeed, if we allow for the sail to be at an arbitrary orientation, then its tangential acceleration is no longer zero. For this, we introduce the angle \( \alpha \), which is the angle between the vector normal to the sail, \( \hat{\mathbf{n}} \), and the radial direction, as seen in Figure \ref{alpha}. We do not allow for full freedom of the sail, and assume that its normal vector remains in the plane that contains the radial vector and is orthogonal to the sail itself. Now, the force due to radiation pressure has two contributions. The incoming photons exert a force that is now proportional to the orthogonal projection of the sail onto the radial direction, therefore of \( IS\cos{\alpha}/c \). This force is in the radial direction. The emitted photons exert a force that has the same modulus, but given that the sail behaves like a mirror, they are emmited in the direction orthogonal to the radial direction, and so the force due to the outgoing radiation is proportional to \( {-\hat{\mathbf{e}}_{\theta}} \). So we have
\begin{equation}
  \mathbf{F}_R(r) = \dfrac{2IS \cos{\alpha}}{c} ( \hat{\mathbf{e}}_{r} - \hat{\mathbf{e}}_{\theta})
\end{equation}
We now observe that because of symmetry, the vector \( \hat{\mathbf{e}}_{r} - \hat{\mathbf{e}}_{\theta}  \) is proportional to \( \hat{\mathbf{n}} \), and, because \( \hat{\mathbf{n}} \) is a unit vector then we have \( \hat{\mathbf{e}}_{r} - \hat{\mathbf{e}}_{\theta} = \cos{\alpha} \hat{\mathbf{n}} \). 
And thus we obtain
\begin{align}
  \mathbf{F}_R(r) &= \dfrac{2IS \cos^2{\alpha}}{c} \hat{\mathbf{n}} \\
									&= \dfrac{2IS \cos^2{\alpha}}{c} (\cos{\alpha} \hat{\mathbf{e}}_r + \sin{\alpha} \hat{\mathbf{e}}_{\theta}) 
\end{align}

Finally, we can rewrite the equations of motion for a solar sail in this more general case as follows:
\begin{align} \label{eq:equations of motion general case}
  \dot{v}_r - \dfrac{v_{\theta}^2}{r} &= (a_R \cos^3{\alpha} - a_G) \left(\dfrac{r_0}{r}\right)^2 \\ 
  \dot{v}_{\theta} + \dfrac{v_r v_{\theta}}{r} &= -a_R	\sin{\alpha} \cos^2{\alpha} \left(\dfrac{r_0}{r}\right)^2
\end{align}
As a consistency check, we note that if \( \alpha = 0 \), that is, the sail is orthogonal to the radiation, we recover \autoref{eq:equations of motion characteristic accelerations} and Equation 2.4. However, the equations we have just obtained are \emph{not} the equations for a particle experiencing central force motion.   

\section{Model analysis and results}
\subsection{Feasibility of the trip} \label{sec:Feasibility of the trip}
To solve \autoref{eq:equations of motion general case} it is common to assume \( \dot{v}_r = 0\), as done in \cite{tsu} and \cite{mcinnes}. With this assumption the equations become those of a logarithmic spiral. Then \( v_r = \dot{r} \) can be isolated and then integrated to find an expresssion for the time of travel between two circular and coplanar orbits of a given radius in terms of only the parameters \( \alpha \), \( a_R \) and \( a_G \):

\begin{equation} \label{eq:time of flight between orbits}
	t=\frac{1}{3}\cdot\frac{r_0^{3/2}-r^{3/2}}{r_0\sqrt{a_R}}\cdot\frac{(a_G/a_R-\cos^3\alpha)^{1/2}}{\sin\alpha\cos^2\alpha}
\end{equation}

Therefore, assuming that the orbits of Mars and the Earth are indeed coplanar, we can compute the time it would take for a solar sail to complete the trip from Earth to Mars, for a given choice of parameters. \autoref{fig:logarithmic spiral} shows an approximation of the trajectory the sail follows.

\begin{figure}
	\centering
	\includegraphics[scale=0.5]{espiral.png}
	\caption{First approximation of the sail trajectory, in blue. The Sun is in the middle and the dashed lines represent the orbits of the Earth and Mars. Axes in AU.}
	\label{fig:logarithmic spiral}
\end{figure}

The value \( a_G \) is independent of the characteristics of the sail, and it has a value of \SI{5,928e-3}{m \cdot s^{-2}}. The characteristic acceleration can be rewritten in terms of the mass of the sail, \( m_s \):
\begin{align*}
  a_R &= \dfrac{2I_0}{c} \dfrac{S}{m} \\
  		&= \dfrac{2I_0}{c} \dfrac{m_s}{\sigma m}
\end{align*}
where \( \sigma \) is the surface density of the sail, as given in the problem. And so we find that \( a_R = \num{6,45e-7} m_s \) using the value for \( I_0 \) given in \cite{hollerman}.

As for the sail angle \( \alpha \), by minimizing \autoref{eq:time of flight between orbits}, it can be seen that the optimum angle depends only on the ratio \( a_R / a_g \) which is commonly called the lightness parameter of the sail and denoted by \( \beta \).  With the values obtained for the characteristic accelerations, the value for \( \beta \) is \( \num{e-4} m_s \). Nevertheless, for values of \( \beta \) up to 0.5, which is the range that is accessible in this situation given that \( m_s \) cannot exceed \SI{2000}{kg}, the optimum angle shows very litle variation from \SI{35.26}{\degree}, as can be seen in \autoref{fig:optimum angle}, which shows the value of the factor dependent on \( \alpha \) in \autoref{eq:time of flight between orbits}.

\begin{figure} 
	\centering
	\includegraphics[scale=0.3]{angle.png}
	\caption{Dependence of flight time on the sail angle $\alpha$}
	\label{fig:optimum angle}
\end{figure}

To test the feasibility of the voyage, we will compute the time of flight as a function of the mass of the sail from Earth's orbit to Mars' with the optimum sail angle. The results are shown in \autoref{fig:time of flight}

Of course, there is no sail mass which produces an optimum time, since allotting more mass to the sail only affects \( a_R \), and not \( a_G \), which is mass-independent. 

\begin{figure}
	\centering
	\includegraphics[scale=0.35]{time}
	\caption{Flight time as a function of the sail mass}
	\label{fig:time of flight}
\end{figure}

With a total available mass of \SI{2000}{kg}, a manned mission propelled with a solar sail is obviously not possible. The purpose of a solar sail would then be to send unmanned cargo to Mars, possibly satellites or rovers to explore its surface. According to \cite{presskit}, the Mars Science Lab (MSL) mission, which sent the rover Curiosity to Mars, had a total mass of \SI{3893}{kg}. The rover itself, however had a mass of \SI{899}{kg}, and most of the remaining mass of the mission was destined to propulsion systems. Given that a hypothetical solar sail propelled mission would have no need for fuel tanks or propulsion systems, it seems reasonable that a payload mass of \SI{1000}{kg} would suffice to carry a rover or similar device to Mars. This would leave another \SI{1000}{kg} to be used for a sail of area \SI{142857}{m^2}. As such, the total time to travel to Mars in these conditions is of approximately 390 days. Again, comparing with a mission such as MSL, which took 254 days to reach Mars, we find that this time is higher, but the potentials savings in fuel and propulsion would possibly make up for it. Therefore we conclude that solar sailing is a viable means of sending small cargo to Mars. 

\subsection{Intercepting Mars}

Thus far we have found the time it would take for the sail to complete the change of orbit. However, if our goal is for the payload to arrive at Mars, then the sail should intercept Mars' orbit at a time when Mars' position is close enough to capture the sail. Considering the simplified equations of motion, the equation for the orbit, \( r(\theta) \), is found to be exponential in \( \theta \) (\cite[p. 155]{mcinnes}). Then, the angle at which the sail intersects the orbit of Mars can be found ---taking \( \theta = 0	\) to be the Mars-Earth closest approach. Its value is around \SI{4.7}{rad}. We can then compute the position of Mars at this instant, given that we have assumed it is following its orbit in uniform circular motion. This position is at \( \theta = \SI{3.6}{rad} \), and thus an encounter does not take place in these conditions. 

We see then that in the conditions of the problem statement, it is not possible to plot a course for Mars with the optimal sail angle. This, then begs the question whether it is possible to find a sail angle that leads to a sail-Mars encounter. To perform this calculation we integrate an expression for the angular velocity of the sail, in terms only of \( r \) and \( \alpha \) found in \cite[p. 156]{mcinnes}, which gives the angle at which the sail intercepts the orbit of Mars for a given \( \alpha \), \( \theta_s(\alpha) \). Furthermore, for a given sail angle we can determine the time it will take for the sail to reach the orbit of Mars. Thus, as Mars is moving in uniform circular motion, we also know the angle it will be at when the interception happens, \( \theta_M(\alpha) \). Thus, we are looking for the value of \( \alpha \) such that \( \theta_s(-a) = \theta_M(\alpha) \). This equation turns out to have no solution in these conditions. Furthermore, if we try to minimize the difference \( \theta_s - \theta_M \) we obtain an angle of about \SI{32}{\degree}, which is close to the optimal angle.

All of this leads us to believe that there is not much else that can be done to improve the characteristics of the voyage in these conditions. In the next two sections we will explore two different methods to improve on the characteristics of the mission.

\subsection{Numerical solution of the general equations of motion}
Since the general equations for a solar sail (\autoref{eq:equations of motion general case} and 2.13) could not be analitically determined, we resorted to numerical methods to understand the behavior of a solar sail without approximations. As is explained in \cite{tsu}, the approximation made in the two previous sections are reasonable, yet not without falt. In particular, \( \dot{v} \) can be up to \( 10 \% \) of the value of \( v_{\theta}^2/r \). Because of this, we deemed this more detailed analysis to be necessary. 

To obtain the numerical solutions, odeint, a numerical ODE solver part of Python's SciPy.integrate module was employed. The system of two second order ODEs was transformed into a set of four first order ODEs, by considering the two additional relationships \( v_r = \dot{r} \) and \( v_{\theta} = r \dot{\theta} \). Given initial conditions, the software then returns values for the position and velocity for a finite set of discrete time steps. The orbit can then be reconstructed from this data if a sufficiently small time step is used.

 \autoref{fig:optimal angle simulation} shows the trajectory followed by the sail when launched with the optimal angle, as established in Section 3.1, \( \alpha = \SI{35.21}{\degree} \). Note that the trajectory of the sail is not tangent to the orbit of Mars at the point of intersection, as it was in \autoref{fig:logarithmic spiral}, nor is the trajectory is a logarithmic spiral.

\begin{figure}
	\centering
	\includegraphics[scale=0.5]{simu.png}
	\caption{Simulation of the trajectory of the sail for the optimal angle.The axes show distance in AU. The blue and red dots depict the solar sail and Mars at the time the sail first intercepts Mars' orbit, respectively.}
	\label{fig:optimal angle simulation}
\end{figure}

The simulation in  \autoref{fig:optimal angle simulation} has been run under the assumption that the initial radial velocity of the sail is zero. This idea, supported by literature and flight plans of previous missions ---\cite{tsu} and \cite{xinos}--- can be explained arguing that the sole effect of being released at escape velocity has on the sail is counteracting the Earth's gravitational pull.

The simulation also allows us to find a first approximation of the velocity with which the sail reaches Mars. Considering both trajectories tangential at the point of interception, which, as can be seen, is a reasonable assumption, the sail's relative velocity to Mars is \SI{-8,5}{km\cdot s^{-1}} at the time of arrival to orbit. Travel time is 248 days according to the simulation.

However, as pointed out in Section 3.2, the sail never intercepts Mars itself. The simulation does not take into account Mars' gravitational pull, but a simple calculation of its strength relative to the Sun's shows that it is virtually zero for all of the orbit.
 
In a first attempt of reaching Mars from the initial proposed configuration and without the use of adjusting maneuvers, various simulations have been run with various sail shift angles in order to find a proper sail angle and flight plan. \autoref{fig:espirals} shows some representative results of such simulations. As it has been mentioned before, gravitational pull from Mars has not been taken into account when running the simulations, since it is not strong enough to have any noticeable effects on the trajectory. As can be seen, in a number of these sample orbits, the sail virtually intercepts Mars. This, however, comes at a large cost in terms of time, since it does so in an almost two year period, as opposed to the 250 days it takes to reach the orbit of Mars in the optimal case.

Assuming the trajectories of Mars and the spacecraft are tangential in the first three plots in \autoref{fig:espirals} one gets relative speeds of \SI{-8,5}{km\cdot s^{-1}}, \SI{-3.5}{km\cdot s^{-1}}  and \SI{-4.7}{km\cdot s^{-1}}, which means the sail would reach Mars at a speed within the range for a safe landing.

\begin{figure}
	\centering
	\includegraphics[scale=0.5]{simulacio1.png}
	\includegraphics[scale=0.5]{simulacio2.png}
	\includegraphics[scale=0.5]{simulacio3.png}
	\includegraphics[scale=0.5]{simulacio4.png}
	\caption{Simulation of sail trajectories for different sail angles, \( \alpha \) in radians. \( T \) indicates the time of flight, in days. The green orbit is Earth's, and the red one is Mars'. The blue and red dots indicate, respectively, the position of the sail and Mars at the time the sail intercepts the orbit of Mars. Axes in AU.}
	\label{fig:espirals}
\end{figure}

\subsection{Sail steering}
So far it has been seen that, in the required conditions, it is hard to plot a course that intercepts Mars and does so in a reasonable time.

\begin{figure}
	\centering
	\label{fig:maniobres}
	\includegraphics[scale=0.55]{Maniobres.png}
	\caption{Trajectory of the sail with the trajectory correcting maneuvres required to stabilize the orbis.The yellow dots show the places at which a sail angle shift takes place. The blue dot shows the sail at the time in intersects Mars' orbit. Axes in AU.}
\end{figure}

A possible way to solve this problem would be to change the orientation of the sail as a means to correct the velocity and trajectory of the sail. In \cite{xinos} a time profile for the sail angle is determined given a set of initial conditions. The complexity of the methods was too high to be applied in this situation, however, the characteristics of the solar sail in \cite{xinos} where similar enough to the ones in the present case to serve as a reference point. The basic idea is to start the trip with the optimal sail angle, which is then increased and then progressively decreased until it reaches zero when the sail is ar Mars' orbit. The purpose behind this profile is to ensure that the sail arrives at the orbit of Mars' with the sail perpendicular to the incoming radiation (zero sail angle).


Obviously, one must not forget that the orbit achieved is not the same as Mars one, but it is actually really close. Notice, moreover, that the last manoeuvre sets $\alpha=0$ something which will imply a resulting force characteristic of a central force, a bit different of the gravitational one because of the sun light orthogonal incidence. Calculations give a really close proximity between Mars and the craft within 5 years since the launching moment with initial conditions, and a relative speed of $2$km/s, something that will ensure a safe landing. Simulation also suggests another monoeuvre would be needed after some years of orbit if it was wanted to mantain it. Even though the aim of this approach was not to land on Mars but to orbit like it, since, changing initial positions in real life would assure the desired landing.

Furthermore, it is required to know $\alpha(t)$ in order to design the flight plan represented in \autoref{fig:maniobres}. This is shown in \autoref{fig:escaleta}. Data of this manoeuvres is inspired once again in \cite{xinos}.


\begin{figure}
	\label{fig:escaleta}
	\includegraphics[scale=0.35]{cocu.png}
	\caption{Representation of the manoeuvres needed to stabilize the orbit.}
\end{figure}
\section{Conclusions}
\subsection{Discussion of the results}
The model proposed proves a solar sail mission to Mars is viable, in terms of cargo carried and time of flight.

Under a first approximation, a distribution of mass among payload and sail has been set to \SI{1000}{kg} each, yielding a reasonable time of flight comparing it to litterature and previous missions to Mars. The amount of cargo seems also reasonable according to such sources.

After deriving the set of differential equations determining the trajectory of the sail, one can make the rather good approximation of supposing the radial velocity to be constant over time. This allows he equations of moviement to be analitically solved, and one finds that, under this approximation, the sail's trajectory is a logarithmic spiral. Then, an optimal starting position of the sail can be found, in terms of the time it takes to get to Mars' orbit, as well as a first approximation of this time. Indeed, reaching Mars' orbit is rather simple, but one finds it too complex to calculate an initial configuration that would assure the spacecraft reachin Mars' itself, and not just its orbit.  

In order to model the problem in a more detalied manner, the general differential equations have to be numerically solved, which allows us to simulate the sail's trajectory. As pointed by the previously mentioned approximation, initial conditions asssuring arrival on the target could not be found under the assumptions given by the problem. Nevertheless, some trajectories have been proposed. These take the sail close enough to Mars to start thinking of landing manoeuvers, and the relative velocities between both bodies fall under the demanded interval. The values for the time of travel of these trajectories are reasonably higher than the optimals, and greater than those of previous missions.

Finally, it has been proposed to approximately ACOPLAR!? the sail's orbit to Mars'. This ensures the spacecraft will reach its target, since both linear velocities are not equal, and to do so with a low relative speed to it. However, simulations show a travel flight of up to five years to ensure contact. A flight plan has been proposed for this latter trajectory, meaning certain changes of the sail's orientation at certain times have been proven to follow such a trajectory.  


\subsection{Strengths and weaknesses}
Research done suggests different aspects of the model which could be remarked:
\begin{itemize}
\item Spacecraft mass is properly distributed between payload and solar sail mass according to previous missions. Moreover this distribution leads to a reasonable flight time.
\item Results are obtained not only for aproximations but also for exact expressions of motion equations. Calculations allow one to visualize trajectories followed by the craft. In addition, simulations seem to be accurate when boundary values are computed. They give an optimal flight time too.
\item Different values of sail pitch angle are tried in order to achieve a better approach to Mars. Other possibilities are suggested also for the same reason. 
\item Arriving to Mars is achieved when taking different initial relative position between the two planets. This is mentioned in the Section 3.2 but also guarantees a succesful mission in Section 3.4. Moreover, it is always made at values of speed that ensure a safe landing.
\item Last part of the report shows that it is possible to perform a succesful flight by making $\alpha$ a function of time. This is, in a first approach, solved numerically. Also necessary manoeuvres are simulated. 
\item Survey proves that propelling crafts by solar sails is totally feasible. At least, when an interpletary flight in a reasonable amount of time is pursued.
\end{itemize}
On the other hand work done has also some points than in a certain way could be improved. Those are:
\begin{itemize}
	\item The initial given conditions do not allow the model to predict an exact and totally accurate flight plan in order to perform a landing on Mars.
	\item Simulations does not consider Mars attraction force. Even though this interaction is quite small compared with other forces involved, it may cause variations in followed trajectories.
	\item Analysis in Section 3.4 is not as accurate as the one made in consulted literature. Used data is partly based on uneducated guess and computed orbit is not the exact Mars' orbit.
\end{itemize}
\clearpage

\begin{btSect}{UphysicscNotes}
	\bibliographystyle{ieeetr}
	\section*{References}	
	\btPrintCited
\end{btSect}

\begin{btSect}{UphysicscNotes}
	\bibliographystyle{ieeetr}
	\section*{Further Reading}	
	\btPrintNotCited
\end{btSect}


\onecolumn
\appendix
\section{Python code for numerical solution}
\begin{minted}[breaklines=true,obeytabs=true,tabsize=2]{python}
	#Simulation of the sail trajectory
	
	import numpy as np
	%matplotlib inline
	import matplotlib.pyplot as plt
	from scipy.integrate import odeint
	
	ar=0.000645
	ag=0.0059288888
	alpha=       #Free to change
	a1=ar*np.cos(alpha)**3-ag
	a2=ar*np.sin(alpha)*np.cos(alpha)**2
	r0=1.5*10**11
	theta0=0
	u0=0
	v0=np.sqrt(2*10**30*6.67*10**(-11)/(1.5*10**11))
	
	def simu(y,t):
		r,theta,u,v=y
		dydt=[u,v/r,a1*(r0/r)**2+v**2/r,a2*(r0/r)**2-u*v/r]
		return dydt
	
	y0=[r0,theta0,u0,v0]
	t=np.linspace(0,380*3600*24*5,100000)
	sol=odeint(simu,y0,t)
	
	rsol=[]
	thsol=[]
	usol=[]
	vsol=[]
	for i in range (0,len(sol)):
			rsol.append(sol[i][0])
			thsol.append(sol[i][1])
			usol.append(sol[i][2])
			vsol.append(sol[i][3])
		
	time=[]      #Find time it reaches Mars' orbit
	for i in range (30000,len(sol2)):
			if rsol2[i]<=(2.27+0.1)*10**11 and rsol2[i]>=(2.27-0.1)*10**11:
					time.append((i,rsol2[i]))
	time
	
	a=t2[]  #Introduce manually time taken from above
	
	t2=np.linspace(0,a,100000)  #trajectory until Mars' orbit
	sol2=odeint(simu2,y0,t2)
	rsol2=[]
	thsol2=[]
	usol2=[]
	vsol2=[]
	for i in range (0,len(sol)):
			rsol.append(sol[i][0])
			thsol.append(sol[i][1])
			usol.append(sol[i][2])
			vsol.append(sol[i][3])
	
	
	x=[]					#Hypothetical trajectory
	y=[]
	for i in range (0,len(sol)):
			x.append(rsol[i]*np.cos(thsol[i])/(1.5*10**11))
			y.append(rsol[i]*np.sin(thsol[i])/(1.5*10**11))
	x2=[]				#Trajectort unil Mars' orbit
	y2=[]
	for i in range (0,len(sol2)):
			x2.append(rsol2[i]*np.cos(thsol2[i])/(1.5*10**11))
			y2.append(rsol2[i]*np.sin(thsol2[i])/(1.5*10**11))
	
	xmf=2.27*10**11*np.cos(1.088*10**(-7)*a)/(1.5*10**11)  #Position of Mars when reaching orbit
	ymf=2.27*10**11*np.sin(1.088*10**(-7)*a)/(1.5*10**11)
	
	xnf=rsol[100000-1]*np.cos(thsol[100000-1])/(1.5*10**11)  #Position of sail when reaching orbit
	ynf=rsol[100000-1]*np.sin(thsol[100000-1])/(1.5*10**11)
	
	def frange(start, end=None, inc=None):
			if end == None:
					end = start + 0.0
					start = 0.0
	
			if inc == None:
					inc = 1.0
	
		L = []
		while 1:
				next = start + len(L) * inc
				if inc > 0 and next >= end:
						break
				elif inc < 0 and next <= end:
						break
				L.append(next)
	
		return L
	
	xm=[]   #Mars orbit
	ym=[]
	for i in frange(0,2*np.pi,0.01):
			xm.append(2.27*10**11*np.cos(i)/(1.5*10**11))
			ym.append(2.27*10**11*np.sin(i)/(1.5*10**11))
	
	xt=[]  #Earth's orbit
	yt=[]
	for i in frange(0,2*np.pi,0.01):
			xt.append(1.5*10**11*np.cos(i)/(1.5*10**11))
			yt.append(1.5*10**11*np.sin(i)/(1.5*10**11))
	
	
	plt.plot(x,y)			#plot results
	plt.plot(x,y,'--',color='blue')
	plt.plot(xt,yt)
	plt.plot(xm,ym)
	plt.axis('equal')
	plt.plot([xmf],[ymf],'rs')
	plt.plot([xnf],[ynf],'bs')

	
\end{minted}

\end{document}

